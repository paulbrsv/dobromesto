{"ast":null,"code":"import{useEffect,useCallback}from'react';import{useSearchParams}from'react-router-dom';// –ì–ª–æ–±–∞–ª—å–Ω–∞—è Map –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ UI\nif(!window.filterStates){window.filterStates=new Map();}export const useUrlFilters=(activeFilters,onFilterChange,filterCounts)=>{var _window$places2,_window$places4,_window$places6;const[searchParams,setSearchParams]=useSearchParams();// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –±–∞–∑–æ–≤—ã—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤\nconst calculateBaseCounts=places=>{console.log('üìä –ü–æ–¥—Å—á–µ—Ç –±–∞–∑–æ–≤—ã—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤');const counts={};places.forEach(place=>{place.attributes.forEach(attr=>{counts[attr]=(counts[attr]||0)+1;});});console.log('üìä –ë–∞–∑–æ–≤—ã–µ —Å—á–µ—Ç—á–∏–∫–∏:',counts);return counts;};// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏\nconst applyFiltersSequentially=(places,filters,baseCounts)=>{console.log('üîÑ –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:',filters);const result={validFilters:[],counts:{...baseCounts},filteredPlaces:places};for(const filter of filters){console.log(`\\nüìå –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∏–ª—å—Ç—Ä: ${filter}`);// –§–∏–ª—å—Ç—Ä—É–µ–º –º–µ—Å—Ç–∞ –ø–æ —Ç–µ–∫—É—â–µ–º—É —Ñ–∏–ª—å—Ç—Ä—É\nconst placesWithFilter=result.filteredPlaces.filter(place=>place.attributes.includes(filter));console.log(`üìä –ù–∞–π–¥–µ–Ω–æ –º–µ—Å—Ç: ${placesWithFilter.length}`);if(placesWithFilter.length>0){// –§–∏–ª—å—Ç—Ä –≤–∞–ª–∏–¥–µ–Ω\nconsole.log(`‚úÖ –§–∏–ª—å—Ç—Ä ${filter} –≤–∞–ª–∏–¥–µ–Ω`);result.validFilters.push(filter);result.filteredPlaces=placesWithFilter;// –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ñ–∏–ª—å—Ç—Ä–æ–≤\nconst remainingFilters=Object.keys(result.counts).filter(attr=>!result.validFilters.includes(attr));console.log('üîÑ –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –¥–ª—è:',remainingFilters);remainingFilters.forEach(attr=>{result.counts[attr]=placesWithFilter.filter(place=>place.attributes.includes(attr)).length;});}else{// –§–∏–ª—å—Ç—Ä –Ω–µ–≤–∞–ª–∏–¥–µ–Ω\nconsole.log(`‚ùå –§–∏–ª—å—Ç—Ä ${filter} –Ω–µ–≤–∞–ª–∏–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º`);result.counts[filter]=0;}}console.log('\\nüìà –†–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:');console.log('–í–∞–ª–∏–¥–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:',result.validFilters);console.log('–ò—Ç–æ–≥–æ–≤—ã–µ —Å—á–µ—Ç—á–∏–∫–∏:',result.counts);return result;};// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π URL\nuseEffect(()=>{var _window$places;if(!((_window$places=window.places)!==null&&_window$places!==void 0&&_window$places.length)){console.log('‚è≥ –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫—É –º–µ—Å—Ç...');return;}const filtersFromUrl=searchParams.get('filter');console.log('\\nüåê –ü–æ–ª—É—á–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä—ã –∏–∑ URL:',filtersFromUrl);// –°—á–∏—Ç–∞–µ–º –±–∞–∑–æ–≤—ã–µ —Å—á–µ—Ç—á–∏–∫–∏\nconst baseCounts=calculateBaseCounts(window.places);if(!filtersFromUrl){console.log('üßπ URL –ø—É—Å—Ç–æ–π, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã');window.filterStates.clear();onFilterChange([]);return;}// –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ\nconst filters=filtersFromUrl.split(',');const{validFilters,counts}=applyFiltersSequentially(window.places,filters,baseCounts);// –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã, –æ–±–Ω–æ–≤–ª—è–µ–º URL\nif(validFilters.length!==filters.length){console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º URL, —É–¥–∞–ª—è—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã');if(validFilters.length>0){// –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL –±–µ–∑ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è\nconst path=window.location.pathname;const newURL=`${path}?filter=${validFilters.join(',')}`;window.history.pushState({},'',newURL);}else{// –£–¥–∞–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä filter, –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å\nconst path=window.location.pathname;window.history.pushState({},'',path);}}// –û–±–Ω–æ–≤–ª—è–µ–º UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ\nconsole.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤');window.filterStates.clear();validFilters.forEach(filter=>{window.filterStates.set(filter,true);});onFilterChange(validFilters);},[searchParams,(_window$places2=window.places)===null||_window$places2===void 0?void 0:_window$places2.length]);// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —Ñ–∏–ª—å—Ç—Ä—É\nconst toggleFilter=useCallback(filter=>{var _window$places3,_searchParams$get;if(!((_window$places3=window.places)!==null&&_window$places3!==void 0&&_window$places3.length)){console.log('‚ö†Ô∏è –ú–µ—Å—Ç–∞ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');return;}console.log('\\nüñ±Ô∏è –ö–ª–∏–∫ –ø–æ —Ñ–∏–ª—å—Ç—Ä—É:',filter);const currentFilters=((_searchParams$get=searchParams.get('filter'))===null||_searchParams$get===void 0?void 0:_searchParams$get.split(',').filter(Boolean))||[];const isActive=currentFilters.includes(filter);if(isActive){// –£–¥–∞–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä\nconsole.log('‚ûñ –£–¥–∞–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä');const newFilters=currentFilters.filter(f=>f!==filter);window.filterStates.set(filter,false);if(newFilters.length>0){// –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL –±–µ–∑ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è\nconst path=window.location.pathname;const newURL=`${path}?filter=${newFilters.join(',')}`;window.history.pushState({},'',newURL);// –í—ã–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è URL, —á—Ç–æ–±—ã React Router –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–ª\nwindow.dispatchEvent(new Event('popstate'));}else{// –£–¥–∞–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä filter, –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å\nconst path=window.location.pathname;window.history.pushState({},'',path);window.dispatchEvent(new Event('popstate'));}}else{// –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è\nconsole.log('‚ûï –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞');const baseCounts=calculateBaseCounts(window.places);const{counts}=applyFiltersSequentially(window.places,[...currentFilters,filter],baseCounts);if(counts[filter]>0){console.log('‚úÖ –§–∏–ª—å—Ç—Ä –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å');const newFilters=[...currentFilters,filter];window.filterStates.set(filter,true);// –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL –±–µ–∑ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è\nconst path=window.location.pathname;const newURL=`${path}?filter=${newFilters.join(',')}`;window.history.pushState({},'',newURL);// –í—ã–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è URL, —á—Ç–æ–±—ã React Router –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–ª\nwindow.dispatchEvent(new Event('popstate'));}else{console.log('‚ùå –§–∏–ª—å—Ç—Ä –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–ª—å–∑—è, —Å—á–µ—Ç—á–∏–∫ = 0');}}},[searchParams,(_window$places4=window.places)===null||_window$places4===void 0?void 0:_window$places4.length]);// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤\nconst resetFilters=useCallback(()=>{console.log('üîÑ –°–±—Ä–æ—Å –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤');window.filterStates.clear();// –£–¥–∞–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä filter, –ø—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL\nconst path=window.location.pathname;window.history.pushState({},'',path);// –í—ã–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è URL, —á—Ç–æ–±—ã React Router –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–ª\nwindow.dispatchEvent(new Event('popstate'));},[]);return{toggleFilter,isFilterAvailable:useCallback(filter=>{var _window$places5,_searchParams$get2;if(!((_window$places5=window.places)!==null&&_window$places5!==void 0&&_window$places5.length))return false;const currentFilters=((_searchParams$get2=searchParams.get('filter'))===null||_searchParams$get2===void 0?void 0:_searchParams$get2.split(',').filter(Boolean))||[];const baseCounts=calculateBaseCounts(window.places);const{counts}=applyFiltersSequentially(window.places,currentFilters,baseCounts);return counts[filter]>0;},[searchParams,(_window$places6=window.places)===null||_window$places6===void 0?void 0:_window$places6.length]),resetFilters};};// –î–æ–±–∞–≤–ª—è–µ–º —Ç–∏–ø—ã –¥–ª—è window\nexport default useUrlFilters;","map":{"version":3,"names":["useEffect","useCallback","useSearchParams","window","filterStates","Map","useUrlFilters","activeFilters","onFilterChange","filterCounts","_window$places2","_window$places4","_window$places6","searchParams","setSearchParams","calculateBaseCounts","places","console","log","counts","forEach","place","attributes","attr","applyFiltersSequentially","filters","baseCounts","result","validFilters","filteredPlaces","filter","placesWithFilter","includes","length","push","remainingFilters","Object","keys","_window$places","filtersFromUrl","get","clear","split","path","location","pathname","newURL","join","history","pushState","set","toggleFilter","_window$places3","_searchParams$get","currentFilters","Boolean","isActive","newFilters","f","dispatchEvent","Event","resetFilters","isFilterAvailable","_window$places5","_searchParams$get2"],"sources":["/Users/borvel/Documents/GitHub/places-app/src/hooks/useUrlFilters.ts"],"sourcesContent":["import { useEffect, useCallback } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { Place } from '../types/places';\n\n// –ì–ª–æ–±–∞–ª—å–Ω–∞—è Map –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ UI\nif (!window.filterStates) {\n  window.filterStates = new Map<string, boolean>();\n}\n\nexport const useUrlFilters = (\n  activeFilters: string[],\n  onFilterChange: (filters: string[]) => void,\n  filterCounts: Record<string, number>\n) => {\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –±–∞–∑–æ–≤—ã—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤\n  const calculateBaseCounts = (places: Place[]) => {\n    console.log('üìä –ü–æ–¥—Å—á–µ—Ç –±–∞–∑–æ–≤—ã—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤');\n    const counts: Record<string, number> = {};\n    \n    places.forEach(place => {\n      place.attributes.forEach(attr => {\n        counts[attr] = (counts[attr] || 0) + 1;\n      });\n    });\n    \n    console.log('üìä –ë–∞–∑–æ–≤—ã–µ —Å—á–µ—Ç—á–∏–∫–∏:', counts);\n    return counts;\n  };\n\n  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏\n  const applyFiltersSequentially = (\n    places: Place[],\n    filters: string[],\n    baseCounts: Record<string, number>\n  ) => {\n    console.log('üîÑ –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:', filters);\n    \n    const result = {\n      validFilters: [] as string[],\n      counts: { ...baseCounts },\n      filteredPlaces: places\n    };\n\n    for (const filter of filters) {\n      console.log(`\\nüìå –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∏–ª—å—Ç—Ä: ${filter}`);\n      \n      // –§–∏–ª—å—Ç—Ä—É–µ–º –º–µ—Å—Ç–∞ –ø–æ —Ç–µ–∫—É—â–µ–º—É —Ñ–∏–ª—å—Ç—Ä—É\n      const placesWithFilter = result.filteredPlaces.filter(\n        place => place.attributes.includes(filter)\n      );\n      \n      console.log(`üìä –ù–∞–π–¥–µ–Ω–æ –º–µ—Å—Ç: ${placesWithFilter.length}`);\n\n      if (placesWithFilter.length > 0) {\n        // –§–∏–ª—å—Ç—Ä –≤–∞–ª–∏–¥–µ–Ω\n        console.log(`‚úÖ –§–∏–ª—å—Ç—Ä ${filter} –≤–∞–ª–∏–¥–µ–Ω`);\n        result.validFilters.push(filter);\n        result.filteredPlaces = placesWithFilter;\n\n        // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ñ–∏–ª—å—Ç—Ä–æ–≤\n        const remainingFilters = Object.keys(result.counts)\n          .filter(attr => !result.validFilters.includes(attr));\n\n        console.log('üîÑ –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –¥–ª—è:', remainingFilters);\n        \n        remainingFilters.forEach(attr => {\n          result.counts[attr] = placesWithFilter.filter(\n            place => place.attributes.includes(attr)\n          ).length;\n        });\n      } else {\n        // –§–∏–ª—å—Ç—Ä –Ω–µ–≤–∞–ª–∏–¥–µ–Ω\n        console.log(`‚ùå –§–∏–ª—å—Ç—Ä ${filter} –Ω–µ–≤–∞–ª–∏–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º`);\n        result.counts[filter] = 0;\n      }\n    }\n\n    console.log('\\nüìà –†–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:');\n    console.log('–í–∞–ª–∏–¥–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:', result.validFilters);\n    console.log('–ò—Ç–æ–≥–æ–≤—ã–µ —Å—á–µ—Ç—á–∏–∫–∏:', result.counts);\n    \n    return result;\n  };\n\n  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π URL\n  useEffect(() => {\n    if (!window.places?.length) {\n      console.log('‚è≥ –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫—É –º–µ—Å—Ç...');\n      return;\n    }\n\n    const filtersFromUrl = searchParams.get('filter');\n    console.log('\\nüåê –ü–æ–ª—É—á–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä—ã –∏–∑ URL:', filtersFromUrl);\n\n    // –°—á–∏—Ç–∞–µ–º –±–∞–∑–æ–≤—ã–µ —Å—á–µ—Ç—á–∏–∫–∏\n    const baseCounts = calculateBaseCounts(window.places);\n\n    if (!filtersFromUrl) {\n      console.log('üßπ URL –ø—É—Å—Ç–æ–π, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã');\n      window.filterStates.clear();\n      onFilterChange([]);\n      return;\n    }\n\n    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ\n    const filters = filtersFromUrl.split(',');\n    const { validFilters, counts } = applyFiltersSequentially(\n      window.places,\n      filters,\n      baseCounts\n    );\n\n    // –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã, –æ–±–Ω–æ–≤–ª—è–µ–º URL\n    if (validFilters.length !== filters.length) {\n      console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º URL, —É–¥–∞–ª—è—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã');\n      if (validFilters.length > 0) {\n        // –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL –±–µ–∑ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è\n        const path = window.location.pathname;\n        const newURL = `${path}?filter=${validFilters.join(',')}`;\n        window.history.pushState({}, '', newURL);\n      } else {\n        // –£–¥–∞–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä filter, –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å\n        const path = window.location.pathname;\n        window.history.pushState({}, '', path);\n      }\n    }\n\n    // –û–±–Ω–æ–≤–ª—è–µ–º UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ\n    console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤');\n    window.filterStates.clear();\n    validFilters.forEach(filter => {\n      window.filterStates.set(filter, true);\n    });\n\n    onFilterChange(validFilters);\n  }, [searchParams, window.places?.length]);\n\n  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —Ñ–∏–ª—å—Ç—Ä—É\n  const toggleFilter = useCallback((filter: string) => {\n    if (!window.places?.length) {\n      console.log('‚ö†Ô∏è –ú–µ—Å—Ç–∞ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');\n      return;\n    }\n\n    console.log('\\nüñ±Ô∏è –ö–ª–∏–∫ –ø–æ —Ñ–∏–ª—å—Ç—Ä—É:', filter);\n    \n    const currentFilters = searchParams.get('filter')?.split(',').filter(Boolean) || [];\n    const isActive = currentFilters.includes(filter);\n    \n    if (isActive) {\n      // –£–¥–∞–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä\n      console.log('‚ûñ –£–¥–∞–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä');\n      const newFilters = currentFilters.filter(f => f !== filter);\n      window.filterStates.set(filter, false);\n      \n      if (newFilters.length > 0) {\n        // –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL –±–µ–∑ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è\n        const path = window.location.pathname;\n        const newURL = `${path}?filter=${newFilters.join(',')}`;\n        window.history.pushState({}, '', newURL);\n        \n        // –í—ã–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è URL, —á—Ç–æ–±—ã React Router –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–ª\n        window.dispatchEvent(new Event('popstate'));\n      } else {\n        // –£–¥–∞–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä filter, –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å\n        const path = window.location.pathname;\n        window.history.pushState({}, '', path);\n        window.dispatchEvent(new Event('popstate'));\n      }\n    } else {\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è\n      console.log('‚ûï –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞');\n      \n      const baseCounts = calculateBaseCounts(window.places);\n      const { counts } = applyFiltersSequentially(\n        window.places,\n        [...currentFilters, filter],\n        baseCounts\n      );\n\n      if (counts[filter] > 0) {\n        console.log('‚úÖ –§–∏–ª—å—Ç—Ä –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å');\n        const newFilters = [...currentFilters, filter];\n        window.filterStates.set(filter, true);\n        \n        // –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL –±–µ–∑ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è\n        const path = window.location.pathname;\n        const newURL = `${path}?filter=${newFilters.join(',')}`;\n        window.history.pushState({}, '', newURL);\n        \n        // –í—ã–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è URL, —á—Ç–æ–±—ã React Router –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–ª\n        window.dispatchEvent(new Event('popstate'));\n      } else {\n        console.log('‚ùå –§–∏–ª—å—Ç—Ä –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–ª—å–∑—è, —Å—á–µ—Ç—á–∏–∫ = 0');\n      }\n    }\n  }, [searchParams, window.places?.length]);\n\n  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤\n  const resetFilters = useCallback(() => {\n    console.log('üîÑ –°–±—Ä–æ—Å –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤');\n    window.filterStates.clear();\n    \n    // –£–¥–∞–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä filter, –ø—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL\n    const path = window.location.pathname;\n    window.history.pushState({}, '', path);\n    \n    // –í—ã–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è URL, —á—Ç–æ–±—ã React Router –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–ª\n    window.dispatchEvent(new Event('popstate'));\n  }, []);\n\n  return {\n    toggleFilter,\n    isFilterAvailable: useCallback((filter: string) => {\n      if (!window.places?.length) return false;\n      \n      const currentFilters = searchParams.get('filter')?.split(',').filter(Boolean) || [];\n      const baseCounts = calculateBaseCounts(window.places);\n      const { counts } = applyFiltersSequentially(\n        window.places,\n        currentFilters,\n        baseCounts\n      );\n      \n      return counts[filter] > 0;\n    }, [searchParams, window.places?.length]),\n    resetFilters\n  };\n};\n\n// –î–æ–±–∞–≤–ª—è–µ–º —Ç–∏–ø—ã –¥–ª—è window\ndeclare global {\n  interface Window {\n    filterStates: Map<string, boolean>;\n    places: Place[];\n  }\n}\n\nexport default useUrlFilters; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}